# Floquet Analysis of Two-Coupled TLSs

## Introduction

In quantized few-state systems, there has been a significant focus on understanding the complex dynamics of quantum systems subjected to strong time-dependent external fields. The study of quantum mechanics involving explicit time-dependent Hamiltonians reveals a range of unique phenomena that are not observable within the area of stationary quantum mechanics.

In this section, we discuss a theoretical method that allows one to obtain analytical solutions to periodic linear differential equations, specifically using Floquet theory of quantum mechanical systems with a time-periodic Hamiltonian.

## Time-Independent Hamiltonian for Two Dipole-Coupled Two-Level Systems

In a quantum model, the free energy term of an atomic Hamiltonian describing two TLSs ('1' and '2') is:

```math
H_{\rm 0,TLSs} = \frac{\hbar\omega_0}{2}{\sigma}_{z,1} + \frac{\hbar\omega_0}{2}{\sigma}_{z,2},
```

where:
- $\hbar\omega_0$ is the energy difference between excited and ground states (assumed to be the same for both TLSs),
- ${\sigma}_{z,i} ={\sigma}_i^+{\sigma}_i^- - {\sigma}_i^-{\sigma}_i^+$ are Pauli matrices,
- $\sigma^+_i=\ket{e_i}\bra{g_i}$ and $\sigma^-_i=\ket{g_i}\bra{e_i}$ describe the excitation and de-excitation of the TLS,
- $\ket{g_i}$ and $\ket{e_i}$ are the ground and excited states of TLS $i$.

For our system, we consider two $s$-dipoles (i.e., $s$-polarized) that are coupled through the self-consistent electromagnetic field. Dipole 1 interacts with the field generated by Dipole 2 (and vice versa), where we apply:

```math
\mathbf{d}=\boldsymbol{\alpha}\cdot\mathbf{E} =\mathbf{d}_i\sigma_{x,i}=\mathbf{d}_i({\sigma}_{i}^++{\sigma}_{i}^-)
```

where $\boldsymbol{\alpha}= \alpha{\bf n_d}{\bf n_d}^\dagger$ is the electric polarizability (volume).

Using a semiclassical approach, we can write our interaction Hamiltonian for the dipole-dipole coupling with quantized dipoles as:

```math
H_{\rm int} = -{\mathbf{d}}\cdot{\mathbf{E}}=- \mathbf{d}_{1}{\sigma}_{x,1}\cdot\mathbf{E}_2(\mathbf{R}_{12})
```

Expanding in terms of the electromagnetic field,

```math
H_{\rm int} = -\mathbf{d}_{1}\cdot\frac{1}{4\pi\epsilon_0}\Bigg[k_2^2({\mathbf{n}_{\rm R}}\times\mathbf{d}_2)\times{\mathbf{n}_{\rm R}}\frac{e^{ik_2R_{12}}}{R_{12}}
+\left[3({\mathbf{n}_{\rm R}}\cdot\mathbf{d}_2){\mathbf{n}_{\rm R}}-\mathbf{d}_2\right]\Bigg(\frac{1}{R_{12}^3}-\frac{ik_2}{R_{12}^2}\Bigg)e^{ik_2R_{12}}\Bigg] {\sigma}_{x,1}\,{\sigma}_{x,2},
```

where:
- $\mathbf{R}_{12}=\mathbf{R}_1-\mathbf{R}_2$ is the displacement between the centers of mass (COM) of Dipole 1 and Dipole 2,
- $R_{12}=|\mathbf{R}_{12}|$, and
- $\bf{n}_{\rm R}$ is the unit vector of $\bf R{12}$

Using the approximation of the electric field in the near-field zone (electric dipole approximation: $|kR|\ll 1$, $e^{ikR}\approx 1$), we get the following expression for the electric field:

```math
\mathbf{E}(\mathbf{R}_{12})=\frac{1}{4\pi\varepsilon_0}[3({\mathbf{n}_{\rm R}}\cdot\mathbf{d})\mathbf{n}_{\rm R}-\mathbf{d}]\frac{1}{R_{12}^3}.
```

Thus, the interaction Hamiltonian in the near-field zone is given by:

```math
H_{\rm int, TLSs} = \frac{d_1 d_2}{4\pi\epsilon_0}\frac{1}{R_{12}^3} {\sigma}_{x,1}\, {\sigma}_{x,2}.
```

The full time-independent Hamiltonian system of two coupled TLSs is:

```math
H_{\rm TLSs} = \frac{\hbar\omega_0}{2}{\sigma}_{z,1} +
\frac{\hbar\omega_0}{2}{\sigma}_{z,2}+
\hbar g_{12} {\sigma}_{x,1}{\sigma}_{x,2},
```

where

```math
\hbar g_{12} = \frac{d_1 d_2}{4\pi\epsilon_0 R_{12}^3},
```
is the static coupling strength.

## Floquet Analysis of Two Coupled TLSs

In the case where the dipole-dipole coupling is periodic in time, we apply Floquet theory to the coupled TLS model. Floquet theory allows us to translate any periodic time-dependent Hamiltonian into an effective time-independent Hamiltonian, represented by an infinity matrix that can be truncated to a finite size.
The time-dependent Schrödinger equation is given by:

```math
i\frac{\partial}{\partial t}\ket{\psi(t)} = H(t)\ket{\psi(t)},
```

where the Hamiltonian inherits time periodicity, $H(t) = H(t+nT)$, and $T = 2\pi/\omega_{\rm m}$ is the period of the perturbation, with $n$ as an integer, and $\omega_{\rm m}$ as the Floquet frequency. The solution is:

```math
\ket{\psi(t)} = U(t,t_0)\ket{\psi(t_0)},
```

where $U(t,t_0) = U(t_0+nT,t_0)=\mathcal{T}_t\exp\left[-i\int^{t}_{t_0}dt'H(t')\right]$ and $\mathcal{T}_t$ is the time-ordering operator.

According to the Floquet theorem, there exists a complete set of solutions $\ket{\psi_\lambda(t)}$, indexed by $\lambda$. These modes are expressed as:

```math
\ket{\psi_\lambda(t)} = e^{-i\varepsilon_\lambda t}\ket{\phi_\lambda(t)},
```

where $\varepsilon_\lambda$ are the quasienergies, and $\ket{\phi_\lambda(t)}$ are the Floquet modes with periodicity $T$, i.e., $\ket{\phi_\lambda(t)}=\ket{\phi_\lambda(t+nT)}$.

Substituting this into the Schrödinger equation results in the eigenvalue problem:

```math
H_F\ket{\phi_\lambda(t)} = \varepsilon_\lambda\ket{\phi_\lambda(t)},
```

where $H_F=H(t)-i\partial_t$ is the Floquet Hamiltonian. The completeness of the Floquet solutions is expressed by:

```math
\braket{\phi_\lambda|\phi_{\lambda'}} = \delta_{\lambda,\lambda'}
,\,\,\,\,\, 
\sum_\lambda\ket{\phi_\lambda(t)}\bra{\phi_\lambda(t)}={I}.
```

Thus, we can express any solution of the Schrödinger equation as:

```math
\ket{\psi(t)} = \sum_\lambda c_\lambda e^{-i\varepsilon_\lambda t}\ket{\phi_\lambda(t)},
```

where $c_\lambda=\braket{\psi_\lambda(0)|\phi_\lambda(0)}$ are the time-independent coefficients.

### Time-Dependent Coefficients

For a system of two coupled dipoles, the state of the system can be written as a tensor product:

```math
\ket{\phi_\lambda(t)}=\ket{1}\otimes\ket{2},
```

where:

```math
\begin{cases}
    \ket{1} = c_{g_1,\lambda}(t)\ket{g_1} + c_{e_1,\lambda}(t)\ket{e_1}, \\
    \ket{2} = c_{g_2,\lambda}(t)\ket{g_2} + c_{e_2,\lambda}(t)\ket{e_2}.
\end{cases}
```

The coefficients $c_{g_1,\lambda}(t)$ and $c_{e_1,\lambda}(t)$ are periodic with period $T$, and $\ket{e_i}$, $\ket{g_i}$ are the excited and ground states of TLS $i$.

We expand the time-dependent coefficients in a Fourier series:

```math
c_{g_1,\lambda}(t) = \sum_{m=-\infty}^\infty c_{g_1,\lambda}^{(m)}e^{im\omega_{\rm m} t}.
```

Inserting this into the eigenvalue equation yields a matrix eigenvalue problem for the Fourier coefficients $c_{\beta,\lambda}$ and the Floquet quasienergies $\varepsilon_\lambda$:

```math
\sum_{m,\beta}\left[\frac{1}{T}\int^T_0 dt H_{\lambda,\lambda'}e^{i(m-n)\omega_{\rm m} t} + m\omega_{\rm m}\delta_{\lambda,\lambda'}\delta_{m,n}\right]c^{(m)}_{\beta,\lambda} = \varepsilon_\lambda c^{(n)}_{\alpha,\lambda}.
```

### Time-Dependent Interaction Hamiltonian

For the displacement of two dipoles with periodic motion, the time-dependent interaction Hamiltonian is:

```math
H_{\rm int, TLS}(t) = \frac{d_1 d_2}{4\pi\epsilon_0}\frac{1}{R_{12}^3(t)} {\sigma}_{x,1}\, {\sigma}_{x,2}.
```

Using the geometric series, we rewrite the interaction Hamiltonian as:

```math
H_{\rm int, TLS}(t) = \hbar g_{12}({\sigma}_{x,1}{\sigma}_{x,2})[1+3M+6M^2...],
```

where:

```math
M(t) = \tilde{\alpha}_{\rm m} \sin(\omega_{\rm m} t),
```

and $\tilde{\alpha}_{\rm m} = \alpha_{\rm m}/R_0$ is the normalized mechanical amplitude.

### Full Hamiltonian

Retaining terms up to the 4th order, the semi-classical time-dependent Hamiltonian for two coupled dipoles is:

```math
    H_{\rm TLS}(t) \approx \frac{\hbar\omega_0}{2}{\sigma}_{z,1} +
    \frac{\hbar\omega_0}{2}{\sigma}_{z,2}+
    \hbar g_{12} {\sigma}_{x,1}{\sigma}_{x,2}
    \\
    +   \hbar g_{12} {\sigma}_{x,1}{\sigma}_{x,2} 
    \left[3\tilde{\alpha}_{\rm m}\sin(\omega_{\rm m}t)+6\tilde{\alpha}_{\rm m}^2\sin^2(\omega_{\rm m}t)\right.
    \\
    \left.+10\tilde{\alpha}_{\rm m}^3\sin^3(\omega_{\rm m}t) +15\tilde{\alpha}_{\rm m}^4\sin^4(\omega_{\rm m}t)\right],
```
where we can separate the time-independent and time-dependent Hamiltonian as $H_{\rm TLS}(t)\rightarrow H_0' + H^F_{\rm AC}(t) = H_{\rm atoms} + H_{\rm int, TLS} + H^F_{\rm AC}(t)$. The solution for this system (without mechanical motion) returns four energy eigenvalues and states: ground, lower and upper polariton, and a two-quanta excitation (biexciton) states. 
%
The latter (upper, 4th) state, represents a nonlinear regime, and is not accessible for two coupled HOs, as they retain a linear response. However, the lower three states turn out to be equivalent to the polariton states for two coupled HOs (for our problems of interest), and the polariton solutions of a quantized Hopfield model, as we also discuss above. This means we can use the three lower states of the coupled TLS problem to conveniently model the QHOs, which is numerically much easier to deal with, as QHOs have a ladder of energy states that often involve a large number of number states, and require a longer simulation time.

## Fourier Approach with Dressed Operator for Two Coupled Two-Level Systems

Next, we transform the time-dependent periodic problem into a time-independent one by inserting Eq.~\eqref{eq: Full Hamiltonian TLS} into Eq.~\eqref{eq: Floquet Hamiltonian matrix representation}, which can be solved using a Fourier approach with a finite Floquet matrix. The matrix size is \( N_F \times N_F \), where \( N_F \) is the product of the truncation number \( N_l = 2l_{\rm max} + 1 \) and the total number of energy states \( N_\lambda \). The time-independent Hamiltonian can be diagonalized into a set of basis \( \{ E_\lambda, \ket{\phi_\lambda} \} \) such that \( H_0' \ket{\phi_\lambda} = E_\lambda \ket{\phi_\lambda} \).

We can write the Hamiltonian matrix element as:

```math
H_{\lambda\lambda'}(t) = E_\lambda \, \delta_{\lambda\lambda'} + A_{\lambda\lambda'} \left[ 3M(t) + 6M^2(t) + \dots \right],
```


Here is how you can format your content into a GitHub README using markdown syntax:

```markdown
# Fourier Approach with Dressed Operator for Two Coupled Two-Level Systems

Next, we transform the time-dependent periodic problem to a time-independent one by inserting the equation for the Full Hamiltonian of TLS into the Floquet Hamiltonian matrix representation, which can be solved by a Fourier approach with a finite Floquet matrix. The size of the matrix is $N_F \times N_F$, where $N_F$ is equal to the multiplication of the truncation number $N_l=2l_{\rm max}+1$ times the number of total energy states $N_\lambda$. The time-independent Hamiltonian can be diagonalized into a set of basis $\{E_\lambda,\ket{\phi_\lambda}\}$ ($H_0'\ket{\phi_\lambda} = E_\lambda\ket{\phi_\lambda}$).

### Hamiltonian Matrix Element

We can write the Hamiltonian matrix element as:

```math
H_{\lambda\lambda'}(t)=E_\lambda\,\delta_{\lambda\lambda'}+A_{\lambda\lambda'}\left[ 3M(t)+6M^2(t)+...\right],
```

where $\ket{\phi_\lambda} = \ket{\alpha}\otimes\ket{\beta}$ and $A_{\lambda\lambda'}= \hbar g_{12}\braket{\phi_\lambda|\sigma_{x,1}\sigma_{x,2}|\phi_{\lambda'}}$ is the matrix element of the Hermitian system operator. To help ensure we have the correct states to mechanically perturb, we dress these two operators $\sigma_{x,1}$ and $\sigma_{x,2}$ with the static interaction terms of the system, namely $\braket{\phi_\lambda|\sigma_{x,j}|\phi_{\lambda'}}$. Then, we project these operators in the new basis to obtain the new atom operator:

```math
    \tilde\sigma_j^+ = \sum_{i=0}^{N_\lambda} \sum_{k=i+1}^{N_\lambda} \braket{\phi_\lambda|\sigma_{x,j}|\phi_{\lambda'}}\ket{\phi_i} \bra{\phi_k},
```

where $\tilde\sigma_j^-=(\tilde\sigma_j^+)^\dagger$ and $\tilde\sigma_{x,j}=\tilde\sigma_j^++\tilde\sigma_j^-$. Thus, we can rewrite the Hamiltonian matrix element as:

```math
    H_{\lambda\lambda'}(t)=E_\lambda\,\delta_{\lambda\lambda'}+\hbar g_{12}(\tilde\sigma_{x,1}\tilde\sigma_{x,2})\left[3M(t)+6M^2(t)+...\right].
```

Without any time-dependence, these states are just the usual dressed states, including the static dipole-dipole interaction, which would yield the familiar superradiant and subradiant states.

### Floquet Hamiltonian Matrix

We then substitute the matrix elements into the Floquet Hamiltonian matrix representation for numerical calculations. First, we note the following integrals for the time-dependent elements with respect to time and switch sine to cosine terms. This allows us to obtain the time-independent matrix, where the Floquet Hamiltonian representation matrix of the coupled TLS models is given by:

```math
    H_{F, \rm TLS} = \sum_{m,n}\sum_{\lambda,\lambda'}(E_\lambda+ m\omega_{\rm m})\delta_{\lambda,\lambda'}\delta_{m,n}
      +\hbar g_{12}(\tilde\sigma_{x,1}\tilde\sigma_{x,2})\\\left[\left(3\tilde{\alpha}_{\rm m}^2+\frac{45}{8}\tilde{\alpha}_{\rm m}^4\right)\delta_{m,n}\right.
     +\left(\frac{3\tilde{\alpha}_{\rm m}}{2}+\frac{15\tilde{\alpha}_{\rm m}^3}{4}\right)\delta_{m,n\pm 1}
     \\
     +\left(\frac{3\tilde{\alpha}_{\rm m}^2}{2}+\frac{15\tilde{\alpha}_{\rm m}^4}{4}\right)\delta_{m,n\pm 2}
     \\
     \left. +\frac{5\tilde{\alpha}_{\rm m}^3}{4}\delta_{m,n\pm 3} + \frac{15\tilde{\alpha}_{\rm m}^4}{16}\delta_{m,n\pm 4}\right].
```

As before, we have expanded the geometric series up to the fourth order.

