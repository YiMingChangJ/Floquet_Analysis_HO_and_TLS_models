# Floquet analysis of two-coupled TLSs

In quantized few-state systems, there has been a significant focus on understanding the complex dynamics of quantum systems subjected to strong time-dependent external fields. The study of quantum mechanics involving explicit time-dependent Hamiltonians reveals a range of unique phenomena that are not observable within the area of stationary quantum mechanics. 
In this section, we discuss a theoretical method that allows one to obtain analytical solutions to periodic linear differential equations, specifically, using Floquet theory of quantum mechanical systems with a time-periodic Hamiltonian. 

## Time independent Hamiltonian for two TLS's

In a quantum model, the free energy term of an atomic Hamiltonian describing two TLSs (`1' and `2') is 

$$
H_{\rm 0,TLSs} = \frac{\hbar\omega_0}{2}{\sigma}_{z,1} + \frac{\hbar\omega_0}{2}{\sigma}_{z,2},
$$

where $\hbar\omega_0$ is the energy difference between excited and ground states (assumed to be the same for both TLSs), ${\sigma}_{z,i} ={\sigma}_i^+{\sigma}_i^- - {\sigma}_i^-{\sigma}_i^+$ 
are Pauli matrices, and $\sigma^+_i=\ket{e_i}\bra{g_i}$ ($\sigma^-_i=\ket{g_i}\bra{e_i}$) describes the excitation (de-excitation) of the TLS,
where $\ket{g_i}$ and $\ket{e_i}$ are the ground and excited states of TLS $i$.
% and $\omega_0$ is the transition frequency of the TLSs (assumed to be the same). 

For our system, we will consider two $s$-dipoles (i.e., $s$-polarized) that are coupled through the self-consistent electromagnetic field, so Dipole 1 interacts with the field generated by Dipole 2 (and vice versa), where we apply Eq.~\eqref{eq: classical E field}.
Moreover, we consider dipole moments induced from: $\mathbf{d}=\boldsymbol{\alpha}\cdot\mathbf{E}
=\mathbf{d}_i\sigma_{x,i}=\mathbf{d}_i({\sigma}_{i}^++{\sigma}_{i}^-$), and ${\bm \alpha}= \alpha{\bf n_d}{\bf n_d}^\dagger$ is the electric polarizability (volume).
Thus, using a semiclassical approach, we can write our interaction Hamiltonian for the dipole-dipole coupling with quantized dipoles as
\begin{align}\label{eq: interaction Hamiltonian}
    H_{\rm int} &= -{\mathbf{d}}\cdot{\mathbf{E}}=- \mathbf{d}_{1}{\sigma}_{x,1}\cdot\mathbf{E}_2(\mathbf{R}_{12}) \nonumber
    \\
      &=-\mathbf{d}_{1}\cdot\frac{1}{4\pi\epsilon_0}\Bigg[k_2^2({\mathbf{n}_{\rm R}}\times\mathbf{d}_2)\times{\mathbf{n}_{\rm R}}\frac{e^{ik_2R_{12}}}{R_{12}} \nonumber
    \\
    & \hspace{-0.8cm}
    +\left[3({\mathbf{n}_{\rm R}}\cdot\mathbf{d}_2){\mathbf{n}_{\rm R}}-\mathbf{d}_2\right]\Bigg(\frac{1}{R_{12}^3}-\frac{ik_2}{R_{12}^2}\Bigg)e^{ik_2R_{12}}\Bigg]
    {\sigma}_{x,1}\,{\sigma}_{x,2}\,, 
\end{align}
where $\mathbf{R}_{12}=\mathbf{R}_1-\mathbf{R}_2$ is the displacement between the COM of Dipole 1 and Dipole 2, $R_{12}=|\mathbf{R}_{12}|$ and $\mathbf{n}_{\rm R}=\mathbf{R}_{12}/R_{12}$ is unit vector of $\mathbf{R}_{12}$. 

Using the approximation of the electric field in the near-field zone 
(electric dipole approximation: $|kR|\ll 1$, $e^{ikR}\approx 1$),
gives~\cite{novotny_hecht_2012}
\begin{equation}\label{eq: near field}
    \mathbf{E}(\mathbf{R}_{12})=\frac{1}{4\pi\varepsilon_0}[3({\mathbf{n}_{\rm R}}\cdot\mathbf{d})\mathbf{n}_{\rm R}-\mathbf{d}]\frac{1}{R_{12}^3}.
\end{equation}
Thus, we can write the interaction Hamiltonian in the near field zone as\footnote{In our model, $\mathbf{n}_{\rm R}$ has only the $x$ component and the dipole moment is polarized in $y$-axis, so that $\mathbf{n}_{\rm R}\cdot\mathbf{d}=0$.}
\begin{equation}
    H_{\rm int, TLSs} = \frac{d_1 d_2}{4\pi\epsilon_0}\frac{1}{R_{12}^3} {\sigma}_{x,1}\, {\sigma}_{x,2}.
\end{equation}
Therefore, the full time-independent Hamiltonian system of two coupled TLSs is 
\begin{equation}\label{eq: time-indept TLS}
    H_{\rm TLSs} = \frac{\hbar\omega_0}{2}{\sigma}_{z,1} +
    \frac{\hbar\omega_0}{2}{\sigma}_{z,2}+
    \hbar g_{12} {\sigma}_{x,1}{\sigma}_{x,2},
\end{equation}
where 
\begin{equation}
\hbar g_{12} = 
\frac{d_1 d_2}{4\pi\epsilon_0 R_{12}^3},
\end{equation}
is the usual static coupling strength.
% and $\mathbf{d}_i = d_i \mathbf{n}_{\rm d}$.

\subsection{Floquet Analysis of Two Coupled TLS's}\label{sec: Floquet analysis TLSs}

Next, we will consider the case when the dipole-dipole coupling is periodic in time, using Floquet theory, and apply it to the coupled TLS model. Floquet engineering is a powerful tool for exploiting  periodic systems and also provides an intuitive understanding of time-driven systems. One of the major strengths of Floquet theory, is that we can translate any periodic time-dependent Hamiltonian into an effective time-independent Hamiltonian represented by an infinity matrix~\cite{Shirley_1965,Sambe_1973}, which can be truncated to a finite size. 

For our present purposes, we are interested in time-dependent Schr\"odinger equation as a differential equation in time,
\begin{equation}\label{eq: TDSE}
    i\frac{\partial}{\partial t}\ket{\psi(t)} = H(t)\ket{\psi(t)},
\end{equation}
where the Hamiltonian inherits the time periodicity, $H(t) = H(t+nT)$ and $T = 2\pi/\omega_{\rm m}$ is the period of the perturbation, where $n$ is an integer, and $\omega_{\rm m}$ denotes the Floquet frequency or (mechanical) driving frequency. The solution is given formally by $\ket{\psi(t)} = U(t,t_0)\ket{\psi(t_0)}$, where $U(t,t_0) = U(t_0+nT,t_0)=\mathcal{T}_t\exp\left[-i\int^{t}_{t_0}dt'H(t')\right]$ and $\mathcal{T}_t$ is the time-ordering operator.
%
According to the Floquet theorem, there exists a complete set of solutions $\ket{\psi_\lambda(t)}$, indexed by $\lambda$~\cite{Shirley_1965,Breuer_2007}. These modes can be expressed  as 
\begin{equation}\label{eq: complete set}
    \ket{\psi_\lambda(t)} = e^{-i\varepsilon_\lambda t}\ket{\phi_\lambda (t)},
\end{equation}
where $\varepsilon_\lambda$ is the Floquet (time-independent) quasienergies or Floquet indices, and $\ket{\phi_\lambda(t)}$ are Floquet modes (states) with periodicity of $T$, $\ket{\phi_\lambda(t)}=\ket{\phi_\lambda(t+nT)}$.

Substituting Eq.~\eqref{eq: complete set} into Eq.~\eqref{eq: TDSE}, yields the eigenvalue problem for the quasienergy $\varepsilon_\lambda$:
\begin{equation}\label{eq: eigenvale equation}
    H_F\ket{\phi_\lambda(t)} = \varepsilon_\lambda\ket{\phi_\lambda(t)},
\end{equation}
where $H_F=H(t)-i\partial_t$ is the Floquet Hamiltonian operator, or 
the so-called quasienergy operator. In addition, the completeness of the Floquet solution is expressed by the relation 

\begin{equation}\label{eq: completeness}
    \braket{\phi_\lambda|\phi_{\lambda'}} = \delta_{\lambda,\lambda'}
    ,\,\,\,\,\, 
    \sum_\lambda\ket{\phi_\lambda(t)}\bra{\phi_\lambda(t)}={I},
\end{equation}
which indicates every value of $t$ 
forms a complete set of basis states. Thus, we can write any solution of time-dependent Schr\"odinger equation as a linear combination,
\begin{equation}\label{eq: general solution of TDSE}
    \ket{\psi(t)} = \sum_\lambda c_\lambda e^{-i\varepsilon_\lambda t}\ket{\phi_\lambda (t)},
\end{equation}
where $c_\lambda=\braket{\psi_\lambda(0)|\phi_\lambda(0)}$ are time-independent complex coefficients. The complexity of computing the eigenvalues and states  can vary based on the particular scenario at hand. Nevertheless, the periodicity of the Floquet modes enables the transformation of the eigenvalue problem in Eq.~\eqref{eq: eigenvale equation} to a time-independent one in an extended Hilbert space, known as a Sambe space ~\cite{Sambe_1973}.

For our system of two coupled dipoles, we can write the combined state of the system as a tensor product of two TLSs: $\ket{\phi_\lambda(t)}=\ket{1}\otimes\ket{2}$, with
\begin{equation}
    \begin{cases}
        \ket{1} = c_{g_1,\lambda}(t)\ket{g_1} + c_{e_1,\lambda}(t)\ket{e_1} %=\sum_{\alpha=e_1,g_1} c_{\alpha,\lambda}(t)\ket{\alpha}
        ,\\
        \ket{2} = c_{g_2,\lambda}(t)\ket{g_2} + c_{e_2,\lambda}(t)\ket{e_2},
        %=\sum_{\beta=e_2,g_2}, c_{\beta,\lambda}(t)\ket{\beta},
    \end{cases}
\end{equation}
where $c_{g,\lambda}(t)$ and $c_{e,\lambda}(t)$ are also periodic with period $T$, and $\ket{e_i}$ and $\ket{g_i}$ are the excited and ground states of TLS $i$.

We then expand these time-dependent coefficients in a Fourier series, $c_{g_1,\lambda}(t)=\sum_{m=-\infty}^\infty c_{g_1,\lambda}^{(m)}e^{im\omega_{\rm m} t}$, where $m$ is an integer, and insert into Eq.~\eqref{eq: eigenvale equation}, to obtain
\begin{equation}
    \sum_{m=-\infty}^\infty\sum_{\beta=e,g} (H_F-\varepsilon_\lambda) c_{\beta,\lambda}^{(m)}e^{im\omega_{\rm m} t}\ket{\phi_{\lambda'}} = \textbf{0}. 
\end{equation}
%
Taking the inner product with $\bra{\phi_\lambda}$, multiplying by $\exp{(-in\omega_{\rm m} t)}/T$, inserting $H_F=H(t)-i\partial_t$, where $n$ is an integer, and integrating from 0 to $T$ with respect to time, we then obtain a matrix eigenvalue equation for the eigenvector of Fourier coefficients $c_{\beta,\lambda}$ and the Floquet quasienergies $\varepsilon_\lambda$:
\begin{multline}\label{eq: Floquet Hamiltonian matrix representation}
    \sum_{m,\beta}\left[\frac{1}{T}\int^T_0 dt H_{\lambda,\lambda'}e^{i(m-n)\omega_{\rm m} t} + m\omega_{\rm m}\delta_{\lambda,\lambda'}\delta_{m,n}\right]c^{(m)}_{\beta,\lambda}\\
    = \varepsilon_\lambda c^{(n)}_{\alpha,\lambda},
\end{multline}
where $H_{\lambda,\lambda'}$ = $\braket{\phi_\lambda|H(t)|\phi_{\lambda'}}$ is the matrix element of full time-dependent Hamiltonian, 
$\ket{\phi_{\lambda'}}=\ket{\alpha}\otimes\ket{\beta}$ 
and $\ket{\alpha},\ket{\beta} = \{\ket{e_j},\ket{g_j}\}$. The quantity in the square bracket of Eq.~\eqref{eq: Floquet Hamiltonian matrix representation} is the matrix representation of $H_F$, $\braket{n,\phi_{\lambda}|H_F|m,\phi_{\lambda}'}$, which is described by the row indexed by ($\lambda$, $n$) and column indexed by ($\lambda'$, $m$). This matrix can be constructed by restricting the number of integers $m$ and $n$, each combination of $(n, m)$ corresponds to a 4-by-4 block ($N_\lambda\times N_\lambda$) of elements match to the matrix components of a coupled two-level Hilbert space Hamiltonian, including $n\omega_{\rm m}$ on the diagonal elements, thus we can calculate this matrix computationally. Again the index $\lambda$ labels the eigenstates, and $m$ and $n$ are the Fourier mode indices. 

In order to determine the frequencies of the spectral lines present in the emitted spectrum, one can numerically calculate the eigenvalues of Eq.~\eqref{eq: Floquet Hamiltonian matrix representation} with respect to a specific truncation of integer values for $n$ and $m$, where $n, m\in{0,\pm 1,...,\pm l_{\rm max}}$ and $l_{\rm max}$ is the order of the harmonics considered in the matrix or the number of sidebands for the Floquet state. The total truncation number is $N_l = 2l_{\rm max} +1$. % which leads to $N_F = N_\lambda \cdot N_l$. Therefore, the matrix representation of $H_F$ is in size of $N_F\times N_F$

Recall, our mechanical motion formula Eq.~\eqref{eq: mechanical motion}, which is periodic and time-dependent. Since the origin of the dipole moves as function of time, we can express the displacement between two dipoles as 
\begin{equation}\label{eq: displacement}
    \mathbf{R}_{12}(t) = \left[R_0 - \alpha_{\rm m}\sin(\omega_{\rm m} t)\right]\hat{x},
\end{equation}
where $R_0$ is the initial displacement between two dipoles. Thus, we can now write the time-dependent interaction Hamiltonian in the near field zone as
\begin{equation}
    H_{\rm int, TLS}(t) = \frac{d_1 d_2}{4\pi\epsilon_0}\frac{1}{R_{12}^3(t)} {\sigma}_{x,1}\, {\sigma}_{x,2}.
\end{equation}

Next, exploiting the geometric series,
\begin{equation}
    \frac{1}{(1-r)^3} = 1 + 3r + 6r^2 + 10r^3 + 15r^4+...,
\end{equation}
with the term
\begin{equation}
    \frac{1}{R_{12}^3(t)} = \frac{1}{R_0^3\left[1-\tilde{\alpha}_{\rm m} \sin(\omega_{\rm m} t)
    \right]^3},
\end{equation}
we can rewrite our interaction Hamiltonian as:
%
\begin{equation}
    H_{\rm int, TLS}(t) = \hbar g_{12}({\sigma}_{x,1}{\sigma}_{x,2})[1+3M+6M^2...],
\end{equation}
%
and
\begin{equation}
M(t) = \tilde{\alpha}_{\rm m} \sin(\omega_{\rm m} t),
\end{equation}
where $\tilde{\alpha}_{\rm m} = \alpha_{\rm m}/R_0$ is the normalized mechanical amplitude.


Retaining terms up to 4th order, the semi-classical time-dependent Hamiltonian of two coupled dipoles with mechanical motion can be written as
\begin{multline}\label{eq: Full Hamiltonian TLS}
    H_{\rm TLS}(t) \approx \frac{\hbar\omega_0}{2}{\sigma}_{z,1} +
    \frac{\hbar\omega_0}{2}{\sigma}_{z,2}+
    \hbar g_{12} {\sigma}_{x,1}{\sigma}_{x,2}
    \\
    +   \hbar g_{12} {\sigma}_{x,1}{\sigma}_{x,2} 
    \left[3\tilde{\alpha}_{\rm m}\sin(\omega_{\rm m}t)+6\tilde{\alpha}_{\rm m}^2\sin^2(\omega_{\rm m}t)\right.
    \\
    \left.+10\tilde{\alpha}_{\rm m}^3\sin^3(\omega_{\rm m}t) +15\tilde{\alpha}_{\rm m}^4\sin^4(\omega_{\rm m}t)\right],
\end{multline}
where we can separate the time-independent and time-dependent Hamiltonian as $H_{\rm TLS}(t)\rightarrow H_0' + H^F_{\rm AC}(t) = H_{\rm atoms} + H_{\rm int, TLS} + H^F_{\rm AC}(t)$. The solution for this system (without mechanical motion) returns four energy eigenvalues and states: ground, lower and upper polariton, and a two-quanta excitation (biexciton) states. 
%
The latter (upper, 4th) state, represents a nonlinear regime, and is not accessible for two coupled HOs, as they retain a linear response. However, the lower three states turn out to be equivalent to the polariton states for two coupled HOs (for our problems of interest), and the polariton solutions of a quantized Hopfield model, as we also discuss above. This means we can use the three lower states of the coupled TLS problem to conveniently model the QHOs, which is numerically much easier to deal with, as QHOs have a ladder of energy states that often involve a large number of number states, and require a longer simulation time.


\subsection{Fourier Approach with Dressed operator for Two Coupled Two-level Systems} \label{subsec: FA_TLS}

Next, we transform the time-dependent periodic problem to a time-independent one by inserting Eq.~\eqref{eq: Full Hamiltonian TLS} into Eq.~\eqref{eq: Floquet Hamiltonian matrix representation}, which can be solved by a Fourier approach with a finite Floquet matrix; the size of the matrix is  $N_F \times N_F$, where $N_F$ is equal to the multiplication of the truncation number $N_l=2l_{\rm max}+1$ times the number of total energy states $N_\lambda$. The time-independent Hamiltonian can be diagonalized into a set of basis $\{E_\lambda,\ket{\phi_\lambda}\}$ ($H_0'\ket{\phi_\lambda} = E_\lambda\ket{\phi_\lambda}$). 

We can write the Hamiltonian matrix element as
\begin{equation}
    H_{\lambda\lambda'}(t)=E_\lambda\,\delta_{\lambda\lambda'}+A_{\lambda\lambda'}\left[ 3M(t)+6M^2(t)+...\right],
\end{equation}
where $\ket{\phi_\lambda} = \ket{\alpha}\otimes\ket{\beta}$ and $A_{\lambda\lambda'}= \hbar g_{12}\braket{\phi_\lambda|\sigma_{x,1}\sigma_{x,2}|\phi_{\lambda'}}$ is the matrix element of the Hermitian system operator. To help ensure we have the correct states to mechanically perturb, we dress these two operators $\sigma_{x,1}$ and $\sigma_{x,2}$ with the 
static interaction terms
%bare states (unperturbed emitter states) 
of the system, namely $\braket{\phi_\lambda|\sigma_{x,j}|\phi_{\lambda'}}$. Then, we project
these operators in the new basis,
%to obtain the new atom operator
\begin{equation}\label{eq: density matrix TLS}
    \tilde\sigma_j^+ = \sum_{i=0}^{N_\lambda} \sum_{k=i+1}^{N_\lambda} \braket{\phi_\lambda|\sigma_{x,j}|\phi_{\lambda'}}\ket{\phi_i} \bra{\phi_k},
\end{equation}
where $\tilde\sigma_j^-=(\tilde\sigma_j^+)^\dagger$ and $\tilde\sigma_{x,j}=\tilde\sigma_j^++\tilde\sigma_j^-$. Thus, we can rewrite the Hamiltonian matrix element as
\begin{equation}\label{eq: matrix elements TLS}
    H_{\lambda\lambda'}(t)=E_\lambda\,\delta_{\lambda\lambda'}+\hbar g_{12}(\tilde\sigma_{x,1}\tilde\sigma_{x,2})\left[3M(t)+6M^2(t)+...\right].
\end{equation}
Without any time-dependence, then these states are just the usual dressed-states including the static dipole-dipole interaction, e.g., which would yield the familiar superradiant and subradiant states.

We then substitute Eq.~\eqref{eq: matrix elements TLS} into 
%the square bracket of 
Eq.~\eqref{eq: Floquet Hamiltonian matrix representation} to calculate the Floquet Hamiltonian matrix, suitable for 
numerical calculations.
We first note
the  following integrals for the time-dependent elements with respect to time and switch sine to cosine 
terms,
%\ymc{(makes no difference, just having $\pm i$ in front of coefficients, but won't affect anything to the results)} 
to obtain our time-independent matrix, the Floquet Hamiltonian representation matrix of the coupled TLS models is given by
\begin{multline}
    H_{F, \rm TLS} = \sum_{m,n}\sum_{\lambda,\lambda'}(E_\lambda+ m\omega_{\rm m})\delta_{\lambda,\lambda'}\delta_{m,n}
      +\hbar g_{12}(\tilde\sigma_{x,1}\tilde\sigma_{x,2})\\\left[\left(3\tilde{\alpha}_{\rm m}^2+\frac{45}{8}\tilde{\alpha}_{\rm m}^4\right)\delta_{m,n}\right.
     +\left(\frac{3\tilde{\alpha}_{\rm m}}{2}+\frac{15\tilde{\alpha}_{\rm m}^3}{4}\right)\delta_{m,n\pm 1}
     \\
     +\left(\frac{3\tilde{\alpha}_{\rm m}^2}{2}+\frac{15\tilde{\alpha}_{\rm m}^4}{4}\right)\delta_{m,n\pm 2}
     \\
     \left. +\frac{5\tilde{\alpha}_{\rm m}^3}{4}\delta_{m,n\pm 3} + \frac{15\tilde{\alpha}_{\rm m}^4}{16}\delta_{m,n\pm 4}\right].
\end{multline}
As before, 
we have expanded the geometric series up to fourth order. 
\begin{figure*}[ht]
    \centering
    \includegraphics[width=1.5\columnwidth]{Figures/Additional_calculations.pdf}
    \caption{Normalized eigenenergies $\tilde{E}$ of (a) time-independent, ($\tilde{\omega}_{\rm m} = 0$ and $\tilde{\alpha}_{\rm m}=0$) and quasienergies of (b) time-dependent ($\tilde{\omega}_{\rm m} = 0.1$ and $\tilde{\alpha}_{\rm m}=0.002$) Hamiltonian of two coupled TLSs, calculated from Eq.~\eqref{eq: time-indept TLS} and~\eqref{eq: Floquet_Hamiltonian_TLS}. Eigenenergies are plotted as function of normalized coupling strength $\eta$. All of the units are normalized by the transition frequency of dipole $\omega_0$. The black dash lines represent analytical solution of eigenfrequencies of full Hamiltonian system (including non-RWA effects, as with our numerical solution) of coupled TLSs given by Eq.~\eqref{eq: analytical_eigenfreq}. 
    % \sh{fix} \sh{move the text at top of graphs slightly up - to not overlap with top of graph line }
    }\label{fig: additional calculation}
\end{figure*}
Here, we demonstrate the results of two-coupled TLSs with [Fig.~\ref{fig: additional calculation} (a)] and without [Fig.~\ref{fig: additional calculation} (b)] mechanical perturbation. As expected, the eigenenergies of two-coupled TLSs becomes quasienergy levels after mechanical drive is active, as shown in Fig.~\ref{fig: schematics}.
